{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _toArray from \"@babel/runtime/helpers/esm/toArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\19215\\\\Desktop\\\\liuguanhua.github.io-master\\\\liuguanhua.github.io\\\\src\\\\components\\\\layout\\\\Sidebar.tsx\";\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect, useRef, useContext, useCallback } from 'react';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nimport Router from 'next/router';\nimport classNames from 'classnames';\nimport { debounce } from 'throttle-debounce';\nimport { isString, isBoolean, isUndefined } from 'util';\nimport styles from '@styles/sass/frame/menus.module.scss';\nimport { isSmallScreen } from '@scripts/helper';\nimport { APP_CONFIG, THEME_COLOR_LIST, DEFAULT_THEME_COLOR, BACKGROUND_COLOR_LIST, DEFAULT_BACKGROUND_COLOR, DEFAULT_DARK_COLOR, DEFAULT_LOVEEYE_COLOR } from '@scripts/constant';\nimport { globalSelf, generateNumList, setStorage, getStorage } from '@scripts/utils';\nimport { CtxStore } from '../context';\nimport Menubar from './Menubar';\nimport { SvgIcon, Switch } from '../common';\nimport { ReactComponent as SvgCheck } from '@fonts/svg/menu/check.svg';\nimport { ReactComponent as SvgSetting } from '@fonts/svg/merge/setting.svg';\nimport { ReactComponent as SvgClose } from '@fonts/svg/shared/close.svg';\nimport { useIsVisible } from '../hooks';\nvar side_wrapper = styles.side_wrapper,\n    logo = styles.logo,\n    theme_wrapper = styles.theme_wrapper,\n    head_menu = styles.head_menu;\nvar _globalSelf$g_config = globalSelf.g_config,\n    name = _globalSelf$g_config.name,\n    logoPic = _globalSelf$g_config.logo;\nvar themeNums = generateNumList(5);\nvar toggleBtnNums = generateNumList(3);\n\nvar mediaScheme = function mediaScheme() {\n  return window.matchMedia('(prefers-color-scheme: dark)');\n};\n\nvar SideLogo = function SideLogo() {\n  return __jsx(Link, {\n    href: \"/\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 5\n    }\n  }, __jsx(\"a\", {\n    className: \"tac pos-rel block \".concat(logo),\n    title: name,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"round bdr-half\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 9\n    }\n  }, __jsx(\"i\", {\n    className: \"icon-circle pos-abs t-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 11\n    }\n  })), __jsx(\"h2\", {\n    className: \"pos-abs r-m-p color-white bg-color-primary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 9\n    }\n  }, __jsx(\"span\", {\n    className: \"vam\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 11\n    }\n  }, \"\\u5C45\\u5C45\", __jsx(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 13\n    }\n  }), \"\\u8D1D\\u8D1D\")), __jsx(\"img\", {\n    className: \"pos-abs vam\",\n    src: logoPic,\n    alt: name,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  })));\n};\n\nvar BackgroundOrColorTheme = function BackgroundOrColorTheme() {\n  var _useState = useState(false),\n      isFollowSystem = _useState[0],\n      setIsFollowSystem = _useState[1];\n\n  var keepData = useRef({\n    isFollowSystem: isFollowSystem\n  });\n\n  var _useState2 = useState(),\n      activeKey = _useState2[0],\n      setActiveKey = _useState2[1];\n\n  var _useState3 = useState(DEFAULT_THEME_COLOR),\n      currentColor = _useState3[0],\n      setCurrentColor = _useState3[1];\n\n  var _useContext = useContext(CtxStore),\n      dispatch = _useContext.dispatch;\n\n  var _BACKGROUND_COLOR_LIS = _toArray(BACKGROUND_COLOR_LIST),\n      rest = _BACKGROUND_COLOR_LIS.slice(1);\n\n  var onSwitchTheme = function onSwitchTheme(_ref) {\n    var backgroundKey = _ref.backgroundKey,\n        _ref$isColor = _ref.isColor,\n        isColor = _ref$isColor === void 0 ? true : _ref$isColor,\n        _ref$isMemory = _ref.isMemory,\n        isMemory = _ref$isMemory === void 0 ? true : _ref$isMemory,\n        _ref$isEqualReturn = _ref.isEqualReturn,\n        isEqualReturn = _ref$isEqualReturn === void 0 ? true : _ref$isEqualReturn;\n    if (isUndefined(backgroundKey)) return;\n\n    try {\n      var isEqual = isEqualReturn && Object.is(activeKey, backgroundKey);\n\n      var _ref2 = isColor && !isEqual ? [Object.is(DEFAULT_BACKGROUND_COLOR, backgroundKey), rest.includes(backgroundKey), Object.is(backgroundKey, DEFAULT_LOVEEYE_COLOR)] : [],\n          _ref3 = _slicedToArray(_ref2, 3),\n          isDefaultColor = _ref3[0],\n          isDarkColor = _ref3[1],\n          isLoveEyeColor = _ref3[2];\n\n      var isEmpty = isEqual || isDefaultColor;\n      var bodyStyle = isEmpty ? {} : {\n        background: isColor ? backgroundKey : \"url(\".concat(require(\"@images/icons/icon-bg\".concat(backgroundKey, \".png\")), \")\")\n      };\n      var docStyle = document.documentElement.style;\n      docStyle.setProperty('--color-default-gray', isLoveEyeColor ? DEFAULT_DARK_COLOR : isDarkColor ? '#fff' : '#aaa');\n      docStyle.setProperty('--color-lighten-gray', isLoveEyeColor ? '#d2d2d2' : isDarkColor ? '#676767' : '#dadada');\n      setActiveKey(isEqual ? void 0 : backgroundKey);\n      isMemory && setStorage(APP_CONFIG, {\n        backgroundKey: isEmpty ? void 0 : backgroundKey\n      });\n      dispatch({\n        type: 'global',\n        payload: {\n          bodyStyle: bodyStyle\n        }\n      });\n    } catch (error) {\n      console.warn(\"\\u5F15\\u5165\\u80CC\\u666F\\u56FE\\u7247\\u5931\\u8D25\");\n    }\n  };\n\n  var onSwitchColor = function onSwitchColor(color) {\n    if (Object.is(currentColor, color)) return;\n    var docStyle = document.documentElement.style;\n    docStyle.setProperty('--color-primary', color);\n    setCurrentColor(color);\n    setStorage(APP_CONFIG, {\n      themeColor: color\n    });\n  };\n\n  var onCustomColorChange = useCallback(debounce(1000, onSwitchColor), []);\n\n  var setThemeBackground = function setThemeBackground() {\n    var _getStorage = getStorage(APP_CONFIG),\n        backgroundKey = _getStorage.backgroundKey;\n\n    onSwitchTheme({\n      backgroundKey: backgroundKey,\n      isColor: isString(backgroundKey) && backgroundKey.includes('#'),\n      isEqualReturn: false\n    });\n  };\n\n  var handleSwitchTheme = function handleSwitchTheme(e) {\n    if (!keepData.current.isFollowSystem) return;\n    var isDarkMode = e ? e.matches : mediaScheme().matches;\n\n    if (isDarkMode) {\n      return onSwitchTheme({\n        backgroundKey: DEFAULT_DARK_COLOR,\n        isMemory: false,\n        isEqualReturn: false\n      });\n    }\n\n    return onSwitchTheme({\n      backgroundKey: DEFAULT_BACKGROUND_COLOR,\n      isMemory: false\n    });\n  };\n\n  var changeIsFollowSystem = function changeIsFollowSystem(isOpen) {\n    setIsFollowSystem(isOpen);\n    keepData.current.isFollowSystem = isOpen;\n  };\n\n  var onFollowSystem = function onFollowSystem(checked) {\n    setStorage(APP_CONFIG, {\n      isFollowSystem: checked\n    });\n    changeIsFollowSystem(checked);\n    checked ? handleSwitchTheme() : setThemeBackground();\n  };\n\n  useEffect(function () {\n    var _getStorage2 = getStorage(APP_CONFIG),\n        themeColor = _getStorage2.themeColor,\n        storeIsFollowSystem = _getStorage2.isFollowSystem;\n\n    themeColor && onSwitchColor(themeColor);\n\n    if (isBoolean(storeIsFollowSystem) && storeIsFollowSystem) {\n      changeIsFollowSystem(true);\n      return handleSwitchTheme();\n    }\n\n    setThemeBackground();\n  }, []);\n  useEffect(function () {\n    var media = mediaScheme();\n    media.addListener ? media.addListener(handleSwitchTheme) : media.addEventListener('change', handleSwitchTheme);\n    return function () {\n      ;\n      (media.removeListener || media.removeListener)(handleSwitchTheme);\n    };\n  }, []);\n  return __jsx(\"section\", {\n    className: \"\".concat(theme_wrapper, \" tac p-b-xl\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 5\n    }\n  }, __jsx(\"h4\", {\n    className: \"font-weight-normal r-m-p\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }\n  }, \"\\u80CC\\u666F\"), __jsx(\"div\", {\n    className: \"m-t-xl\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 7\n    }\n  }, BACKGROUND_COLOR_LIST.map(function (color) {\n    return __jsx(\"button\", {\n      className: classNames('pos-rel', {\n        active: !isFollowSystem && Object.is(activeKey, color)\n      }),\n      disabled: isFollowSystem,\n      style: {\n        width: 42,\n        height: 32,\n        backgroundColor: color\n      },\n      onClick: function onClick() {\n        return onSwitchTheme({\n          backgroundKey: color\n        });\n      },\n      key: color,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 13\n      }\n    }, __jsx(SvgIcon, {\n      className: \"pos-abs tblr-0 m-auto hide color-primary\",\n      component: SvgCheck,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 15\n      }\n    }));\n  }), themeNums.slice(-(themeNums.length - 2)).map(function (item) {\n    var index = ++item;\n    return __jsx(\"button\", _extends({\n      className: classNames('pos-rel', {\n        active: !isFollowSystem && Object.is(activeKey, index)\n      }),\n      disabled: isFollowSystem\n    }, activeKey && {\n      style: {\n        boxShadow: '0px 0px 5px var(--color-lighten-gray)'\n      }\n    }, {\n      onClick: function onClick() {\n        return onSwitchTheme({\n          backgroundKey: index,\n          isColor: false\n        });\n      },\n      key: index,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 13\n      }\n    }), __jsx(\"i\", {\n      className: \"icon-bg\".concat(index),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 15\n      }\n    }), __jsx(SvgIcon, {\n      className: \"pos-abs tblr-0 m-auto hide color-primary\",\n      component: SvgCheck,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 15\n      }\n    }));\n  }), __jsx(\"h4\", {\n    className: \"font-weight-normal r-m-p m-t-b-xl\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 9\n    }\n  }, \"\\u8DDF\\u968F\\u7CFB\\u7EDF:\", __jsx(\"span\", {\n    className: \"m-l-xxs\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 11\n    }\n  }, __jsx(Switch, {\n    checked: isFollowSystem,\n    checkedChildren: \"\\u5F00\",\n    uncheckedChildren: \"\\u5173\",\n    onChange: onFollowSystem,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 13\n    }\n  })))), __jsx(\"h4\", {\n    className: \"font-weight-normal r-m-p m-b-xl\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 7\n    }\n  }, \"\\u989C\\u8272\"), THEME_COLOR_LIST.map(function (color, index) {\n    var isLast = Object.is(THEME_COLOR_LIST.length - 1, index);\n    return __jsx(\"button\", _extends({\n      className: classNames('pos-rel', {\n        active: Object.is(currentColor, color)\n      }),\n      style: {\n        width: 42,\n        height: 32,\n        backgroundColor: color\n      }\n    }, !isLast && {\n      onClick: function onClick() {\n        return onSwitchColor(color);\n      }\n    }, {\n      key: color,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 11\n      }\n    }), __jsx(SvgIcon, {\n      className: \"pos-abs tblr-0 m-auto hide color-white\",\n      component: SvgCheck,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 13\n      }\n    }), isLast && __jsx(React.Fragment, null, __jsx(\"input\", {\n      className: \"input-custom-color pos-abs tblr-0 w-h-100 cursign\",\n      onChange: function onChange(_ref4) {\n        var value = _ref4.target.value;\n        return onCustomColorChange(value);\n      },\n      type: \"color\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 17\n      }\n    }), __jsx(\"span\", {\n      className: \"font-size-xs color-white\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 17\n      }\n    }, \"\\u81EA\\u5B9A\\u4E49\")));\n  }));\n};\n\nvar Sidebar = function Sidebar() {\n  var _useContext2 = useContext(CtxStore),\n      store = _useContext2.store;\n\n  var bodyStyle = store.bodyStyle;\n  var keepData = useRef({\n    pathname: ''\n  });\n\n  var _useRouter = useRouter(),\n      pathname = _useRouter.pathname;\n\n  var _useState4 = useState(false),\n      toogle = _useState4[0],\n      setToogle = _useState4[1];\n\n  var _useIsVisible = useIsVisible(),\n      isShow = _useIsVisible.isShow,\n      toggleContent = _useIsVisible.toggleContent;\n\n  useEffect(function () {\n    if (!isSmallScreen()) return;\n\n    var handleRouteChange = function handleRouteChange(url) {\n      var pathname = keepData.current.pathname;\n\n      if (!Object.is(url, pathname)) {\n        setToogle(false);\n      }\n    };\n\n    var events = Router.events;\n    events.on('routeChangeStart', handleRouteChange);\n    return function () {\n      events.off('routeChangeStart', handleRouteChange);\n    };\n  }, []);\n  useEffect(function () {\n    keepData.current.pathname = pathname;\n  }, [pathname]);\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"pos-fix tar z-3 t-l-0 w-100 bg-color-primary \".concat(head_menu),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 7\n    }\n  }, __jsx(\"button\", {\n    className: classNames(\"bg-color-transparent vam\", {\n      active: toogle\n    }),\n    onClick: function onClick() {\n      return setToogle(!toogle);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 351,\n      columnNumber: 9\n    }\n  }, toggleBtnNums.map(function (num) {\n    return __jsx(\"span\", {\n      key: num,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 13\n      }\n    }, __jsx(\"i\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 15\n      }\n    }));\n  }))), __jsx(\"section\", {\n    style: _objectSpread({}, toogle && {\n      left: 0\n    }, {\n      zIndex: 13\n    }, bodyStyle),\n    className: classNames(\"pos-fix t-l-0 h-100 bg-color-white \".concat(side_wrapper), {\n      active: toogle\n    }),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 7\n    }\n  }, __jsx(SideLogo, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 379,\n      columnNumber: 9\n    }\n  }), __jsx(Menubar, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 9\n    }\n  }), __jsx(\"div\", {\n    className: \"pos-rel\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 381,\n      columnNumber: 9\n    }\n  }, __jsx(\"button\", {\n    onClick: toggleContent,\n    className: classNames('btn-theme-setting pos-abs bg-color-primary color-white p-tblr-xxs font-size-lg bd-none z-1'),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 382,\n      columnNumber: 11\n    }\n  }, __jsx(SvgIcon, {\n    component: isShow ? SvgClose : SvgSetting,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 13\n    }\n  })), __jsx(\"div\", {\n    className: \"pos-abs tblr-0 m-auto\",\n    style: {\n      transform: \"translateX(\".concat(isShow ? 0 : '-100%', \")\"),\n      transition: '.5s'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 390,\n      columnNumber: 11\n    }\n  }, __jsx(BackgroundOrColorTheme, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 13\n    }\n  })))));\n};\n\nexport default Sidebar;","map":{"version":3,"sources":["C:/Users/19215/Desktop/liuguanhua.github.io-master/liuguanhua.github.io/src/components/layout/Sidebar.tsx"],"names":["React","useState","useEffect","useRef","useContext","useCallback","Link","useRouter","Router","classNames","debounce","isString","isBoolean","isUndefined","styles","isSmallScreen","APP_CONFIG","THEME_COLOR_LIST","DEFAULT_THEME_COLOR","BACKGROUND_COLOR_LIST","DEFAULT_BACKGROUND_COLOR","DEFAULT_DARK_COLOR","DEFAULT_LOVEEYE_COLOR","globalSelf","generateNumList","setStorage","getStorage","CtxStore","Menubar","SvgIcon","Switch","ReactComponent","SvgCheck","SvgSetting","SvgClose","useIsVisible","side_wrapper","logo","theme_wrapper","head_menu","g_config","name","logoPic","themeNums","toggleBtnNums","mediaScheme","window","matchMedia","SideLogo","BackgroundOrColorTheme","isFollowSystem","setIsFollowSystem","keepData","activeKey","setActiveKey","currentColor","setCurrentColor","dispatch","rest","onSwitchTheme","backgroundKey","isColor","isMemory","isEqualReturn","isEqual","Object","is","includes","isDefaultColor","isDarkColor","isLoveEyeColor","isEmpty","bodyStyle","background","require","docStyle","document","documentElement","style","setProperty","type","payload","error","console","warn","onSwitchColor","color","themeColor","onCustomColorChange","setThemeBackground","handleSwitchTheme","e","current","isDarkMode","matches","changeIsFollowSystem","isOpen","onFollowSystem","checked","storeIsFollowSystem","media","addListener","addEventListener","removeListener","map","active","width","height","backgroundColor","slice","length","item","index","boxShadow","isLast","onClick","value","target","Sidebar","store","pathname","toogle","setToogle","isShow","toggleContent","handleRouteChange","url","events","on","off","num","left","zIndex","transform","transition"],"mappings":"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","sourcesContent":["import React, {\r\n  useState,\r\n  useEffect,\r\n  useRef,\r\n  useContext,\r\n  useCallback,\r\n} from 'react'\r\nimport Link from 'next/link'\r\nimport { useRouter } from 'next/router'\r\nimport Router from 'next/router'\r\nimport classNames from 'classnames'\r\nimport { debounce } from 'throttle-debounce'\r\nimport { isString, isBoolean, isUndefined } from 'util'\r\n\r\nimport styles from '@styles/sass/frame/menus.module.scss'\r\n\r\nimport { isSmallScreen } from '@scripts/helper'\r\nimport {\r\n  APP_CONFIG,\r\n  THEME_COLOR_LIST,\r\n  DEFAULT_THEME_COLOR,\r\n  BACKGROUND_COLOR_LIST,\r\n  DEFAULT_BACKGROUND_COLOR,\r\n  DEFAULT_DARK_COLOR,\r\n  DEFAULT_LOVEEYE_COLOR,\r\n} from '@scripts/constant'\r\nimport {\r\n  globalSelf,\r\n  generateNumList,\r\n  setStorage,\r\n  getStorage,\r\n} from '@scripts/utils'\r\n\r\nimport { CtxStore } from '../context'\r\n\r\nimport Menubar from './Menubar'\r\nimport { SvgIcon, Switch } from '../common'\r\n\r\nimport { ReactComponent as SvgCheck } from '@fonts/svg/menu/check.svg'\r\nimport { ReactComponent as SvgSetting } from '@fonts/svg/merge/setting.svg'\r\nimport { ReactComponent as SvgClose } from '@fonts/svg/shared/close.svg'\r\n\r\nimport { useIsVisible } from '../hooks'\r\n\r\nconst { side_wrapper, logo, theme_wrapper, head_menu } = styles\r\nconst { name, logo: logoPic } = globalSelf.g_config\r\nconst themeNums = generateNumList(5)\r\nconst toggleBtnNums = generateNumList(3)\r\nconst mediaScheme = () => window.matchMedia('(prefers-color-scheme: dark)')\r\n\r\nconst SideLogo: React.FC = () => {\r\n  return (\r\n    <Link href=\"/\">\r\n      <a className={`tac pos-rel block ${logo}`} title={name}>\r\n        <div className=\"round bdr-half\">\r\n          <i className=\"icon-circle pos-abs t-0\" />\r\n        </div>\r\n        <h2 className=\"pos-abs r-m-p color-white bg-color-primary\">\r\n          <span className=\"vam\">\r\n            居居\r\n            <br />\r\n            贝贝\r\n          </span>\r\n        </h2>\r\n        <img className=\"pos-abs vam\" src={logoPic} alt={name} />\r\n      </a>\r\n    </Link>\r\n  )\r\n}\r\n\r\nconst BackgroundOrColorTheme: React.FC = () => {\r\n  const [isFollowSystem, setIsFollowSystem] = useState(false)\r\n  const keepData = useRef({\r\n    isFollowSystem,\r\n  })\r\n  const [activeKey, setActiveKey] = useState()\r\n  const [currentColor, setCurrentColor] = useState(DEFAULT_THEME_COLOR)\r\n  const { dispatch } = useContext(CtxStore)\r\n\r\n  const [, ...rest] = BACKGROUND_COLOR_LIST\r\n\r\n  const onSwitchTheme = ({\r\n    backgroundKey,\r\n    isColor = true,\r\n    isMemory = true,\r\n    isEqualReturn = true,\r\n  }: {\r\n    backgroundKey: any\r\n    isColor?: boolean\r\n    isMemory?: boolean\r\n    isEqualReturn?: boolean\r\n  }) => {\r\n    if (isUndefined(backgroundKey)) return\r\n    try {\r\n      const isEqual = isEqualReturn && Object.is(activeKey, backgroundKey)\r\n      const [isDefaultColor, isDarkColor, isLoveEyeColor] =\r\n        isColor && !isEqual\r\n          ? [\r\n              Object.is(DEFAULT_BACKGROUND_COLOR, backgroundKey),\r\n              rest.includes(backgroundKey),\r\n              Object.is(backgroundKey, DEFAULT_LOVEEYE_COLOR),\r\n            ]\r\n          : []\r\n      const isEmpty = isEqual || isDefaultColor\r\n      const bodyStyle = isEmpty\r\n        ? {}\r\n        : {\r\n            background: isColor\r\n              ? backgroundKey\r\n              : `url(${require(`@images/icons/icon-bg${backgroundKey}.png`)})`,\r\n          }\r\n      const docStyle = document.documentElement.style\r\n\r\n      docStyle.setProperty(\r\n        '--color-default-gray',\r\n        isLoveEyeColor ? DEFAULT_DARK_COLOR : isDarkColor ? '#fff' : '#aaa'\r\n      )\r\n      docStyle.setProperty(\r\n        '--color-lighten-gray',\r\n        isLoveEyeColor ? '#d2d2d2' : isDarkColor ? '#676767' : '#dadada'\r\n      )\r\n      setActiveKey(isEqual ? void 0 : backgroundKey)\r\n      isMemory &&\r\n        setStorage(APP_CONFIG, {\r\n          backgroundKey: isEmpty ? void 0 : backgroundKey,\r\n        })\r\n      dispatch({\r\n        type: 'global',\r\n        payload: {\r\n          bodyStyle,\r\n        },\r\n      })\r\n    } catch (error) {\r\n      console.warn(`引入背景图片失败`)\r\n    }\r\n  }\r\n\r\n  const onSwitchColor = (color) => {\r\n    if (Object.is(currentColor, color)) return\r\n    const docStyle = document.documentElement.style\r\n    docStyle.setProperty('--color-primary', color)\r\n    setCurrentColor(color)\r\n    setStorage(APP_CONFIG, {\r\n      themeColor: color,\r\n    })\r\n  }\r\n\r\n  const onCustomColorChange = useCallback(debounce(1000, onSwitchColor), [])\r\n\r\n  const setThemeBackground = () => {\r\n    const { backgroundKey } = getStorage(APP_CONFIG)\r\n    onSwitchTheme({\r\n      backgroundKey,\r\n      isColor: isString(backgroundKey) && backgroundKey.includes('#'),\r\n      isEqualReturn: false,\r\n    })\r\n  }\r\n\r\n  const handleSwitchTheme = (e?: MediaQueryListEvent) => {\r\n    if (!keepData.current.isFollowSystem) return\r\n    const isDarkMode = e ? e.matches : mediaScheme().matches\r\n    if (isDarkMode) {\r\n      return onSwitchTheme({\r\n        backgroundKey: DEFAULT_DARK_COLOR,\r\n        isMemory: false,\r\n        isEqualReturn: false,\r\n      })\r\n    }\r\n    return onSwitchTheme({\r\n      backgroundKey: DEFAULT_BACKGROUND_COLOR,\r\n      isMemory: false,\r\n    })\r\n  }\r\n\r\n  const changeIsFollowSystem = (isOpen: boolean) => {\r\n    setIsFollowSystem(isOpen)\r\n    keepData.current.isFollowSystem = isOpen\r\n  }\r\n\r\n  const onFollowSystem = (checked) => {\r\n    setStorage(APP_CONFIG, {\r\n      isFollowSystem: checked,\r\n    })\r\n    changeIsFollowSystem(checked)\r\n    checked ? handleSwitchTheme() : setThemeBackground()\r\n  }\r\n\r\n  useEffect(() => {\r\n    const { themeColor, isFollowSystem: storeIsFollowSystem } = getStorage(\r\n      APP_CONFIG\r\n    )\r\n    themeColor && onSwitchColor(themeColor)\r\n    if (isBoolean(storeIsFollowSystem) && storeIsFollowSystem) {\r\n      changeIsFollowSystem(true)\r\n      return handleSwitchTheme()\r\n    }\r\n    setThemeBackground()\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    const media = mediaScheme()\r\n    media.addListener\r\n      ? media.addListener(handleSwitchTheme)\r\n      : media.addEventListener('change', handleSwitchTheme)\r\n    return () => {\r\n      ;(media.removeListener || media.removeListener)(handleSwitchTheme)\r\n    }\r\n  }, [])\r\n\r\n  return (\r\n    <section className={`${theme_wrapper} tac p-b-xl`}>\r\n      <h4 className=\"font-weight-normal r-m-p\">背景</h4>\r\n      <div className=\"m-t-xl\">\r\n        {BACKGROUND_COLOR_LIST.map((color) => {\r\n          return (\r\n            <button\r\n              className={classNames('pos-rel', {\r\n                active: !isFollowSystem && Object.is(activeKey, color),\r\n              })}\r\n              disabled={isFollowSystem}\r\n              style={{\r\n                width: 42,\r\n                height: 32,\r\n                backgroundColor: color,\r\n              }}\r\n              onClick={() => onSwitchTheme({ backgroundKey: color })}\r\n              key={color}\r\n            >\r\n              <SvgIcon\r\n                className=\"pos-abs tblr-0 m-auto hide color-primary\"\r\n                component={SvgCheck}\r\n              />\r\n            </button>\r\n          )\r\n        })}\r\n        {themeNums.slice(-(themeNums.length - 2)).map((item) => {\r\n          const index = ++item\r\n          return (\r\n            <button\r\n              className={classNames('pos-rel', {\r\n                active: !isFollowSystem && Object.is(activeKey, index),\r\n              })}\r\n              disabled={isFollowSystem}\r\n              {...(activeKey && {\r\n                style: {\r\n                  boxShadow: '0px 0px 5px var(--color-lighten-gray)',\r\n                },\r\n              })}\r\n              onClick={() =>\r\n                onSwitchTheme({ backgroundKey: index, isColor: false })\r\n              }\r\n              key={index}\r\n            >\r\n              <i className={`icon-bg${index}`} />\r\n              <SvgIcon\r\n                className=\"pos-abs tblr-0 m-auto hide color-primary\"\r\n                component={SvgCheck}\r\n              />\r\n            </button>\r\n          )\r\n        })}\r\n        <h4 className=\"font-weight-normal r-m-p m-t-b-xl\">\r\n          跟随系统:\r\n          <span className=\"m-l-xxs\">\r\n            <Switch\r\n              checked={isFollowSystem}\r\n              checkedChildren=\"开\"\r\n              uncheckedChildren=\"关\"\r\n              onChange={onFollowSystem}\r\n            />\r\n          </span>\r\n        </h4>\r\n      </div>\r\n      <h4 className=\"font-weight-normal r-m-p m-b-xl\">颜色</h4>\r\n      {THEME_COLOR_LIST.map((color, index) => {\r\n        const isLast = Object.is(THEME_COLOR_LIST.length - 1, index)\r\n        return (\r\n          <button\r\n            className={classNames('pos-rel', {\r\n              active: Object.is(currentColor, color),\r\n            })}\r\n            style={{\r\n              width: 42,\r\n              height: 32,\r\n              backgroundColor: color,\r\n            }}\r\n            {...(!isLast && {\r\n              onClick: () => onSwitchColor(color),\r\n            })}\r\n            key={color}\r\n          >\r\n            <SvgIcon\r\n              className=\"pos-abs tblr-0 m-auto hide color-white\"\r\n              component={SvgCheck}\r\n            />\r\n            {isLast && (\r\n              <>\r\n                <input\r\n                  className=\"input-custom-color pos-abs tblr-0 w-h-100 cursign\"\r\n                  onChange={({ target: { value } }) =>\r\n                    onCustomColorChange(value)\r\n                  }\r\n                  type=\"color\"\r\n                />\r\n                <span className=\"font-size-xs color-white\">自定义</span>\r\n              </>\r\n            )}\r\n          </button>\r\n        )\r\n      })}\r\n    </section>\r\n  )\r\n}\r\n\r\ninterface ISidebarProps {}\r\n\r\nconst Sidebar: React.FC<ISidebarProps> = () => {\r\n  const { store } = useContext(CtxStore)\r\n  const { bodyStyle } = store\r\n  const keepData = useRef({\r\n    pathname: '',\r\n  })\r\n  const { pathname } = useRouter()\r\n  const [toogle, setToogle] = useState(false)\r\n  const { isShow, toggleContent } = useIsVisible()\r\n\r\n  useEffect(() => {\r\n    if (!isSmallScreen()) return\r\n    const handleRouteChange = (url) => {\r\n      const { pathname } = keepData.current\r\n      if (!Object.is(url, pathname)) {\r\n        setToogle(false)\r\n      }\r\n    }\r\n    const { events } = Router\r\n    events.on('routeChangeStart', handleRouteChange)\r\n    return () => {\r\n      events.off('routeChangeStart', handleRouteChange)\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    keepData.current.pathname = pathname\r\n  }, [pathname])\r\n\r\n  return (\r\n    <>\r\n      <div\r\n        className={`pos-fix tar z-3 t-l-0 w-100 bg-color-primary ${head_menu}`}\r\n      >\r\n        <button\r\n          className={classNames(`bg-color-transparent vam`, {\r\n            active: toogle,\r\n          })}\r\n          onClick={() => setToogle(!toogle)}\r\n        >\r\n          {toggleBtnNums.map((num) => (\r\n            <span key={num}>\r\n              <i />\r\n            </span>\r\n          ))}\r\n        </button>\r\n      </div>\r\n      <section\r\n        style={{\r\n          ...(toogle && {\r\n            left: 0,\r\n          }),\r\n          zIndex: 13,\r\n          ...bodyStyle,\r\n        }}\r\n        className={classNames(\r\n          `pos-fix t-l-0 h-100 bg-color-white ${side_wrapper}`,\r\n          {\r\n            active: toogle,\r\n          }\r\n        )}\r\n      >\r\n        <SideLogo />\r\n        <Menubar />\r\n        <div className=\"pos-rel\">\r\n          <button\r\n            onClick={toggleContent}\r\n            className={classNames(\r\n              'btn-theme-setting pos-abs bg-color-primary color-white p-tblr-xxs font-size-lg bd-none z-1'\r\n            )}\r\n          >\r\n            <SvgIcon component={isShow ? SvgClose : SvgSetting} />\r\n          </button>\r\n          <div\r\n            className=\"pos-abs tblr-0 m-auto\"\r\n            style={{\r\n              transform: `translateX(${isShow ? 0 : '-100%'})`,\r\n              transition: '.5s',\r\n            }}\r\n          >\r\n            <BackgroundOrColorTheme />\r\n          </div>\r\n        </div>\r\n      </section>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Sidebar\r\n"]},"metadata":{},"sourceType":"module"}